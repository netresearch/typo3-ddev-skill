#!/bin/bash

## Description: Generate Makefile for TYPO3 extension development
## Usage: generate-makefile
## Example: ddev generate-makefile

EXTENSION_KEY=$(basename "$(pwd)")
DDEV_PROJECT=$(ddev describe -j | jq -r '.name' 2>/dev/null || echo "$EXTENSION_KEY")

# Simple sed-based substitution
sed -e "s/{{EXTENSION_NAME}}/$EXTENSION_KEY/g" \
    -e "s/{{EXTENSION_KEY}}/$EXTENSION_KEY/g" \
    -e "s/{{DDEV_PROJECT}}/$DDEV_PROJECT/g" \
    /var/www/html/.ddev/Makefile.template > /var/www/html/Makefile

echo "âœ… Makefile generated successfully!"
echo "Run 'make help' to see available commands"
